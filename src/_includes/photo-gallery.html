<div class="photo-gallery">
  {% assign sorted_gallery = gallery | sort: 'order' %}
  {% for item in sorted_gallery %}
    {% if gallery_tags %}
      {% assign show_item = false %}
      {% for tag in gallery_tags %}
        {% if item.tags contains tag %}
          {% assign show_item = true %}
          {% break %}
        {% endif %}
      {% endfor %}
    {% else %}
      {% assign show_item = true %}
    {% endif %}
    
    {% if show_item %}
      <a href="/assets/photos/{{ item.filename }}" class="gallery-item" data-tags="{{ item.tags | join: ',' }}" target="_blank">
        <img src="/assets/photos/{{ item.filename }}" alt="{{ item.alt }}" loading="lazy" decoding="async">
      </a>
    {% endif %}
  {% endfor %}
</div>